# 구현 계획 - 시퀀스 자동화 및 알람 로직 개선 (Sequence Automation)

## 목표 설명 (Goal Description)
사용자의 요청에 따라 시간 도달 시 동작을 세분화하고, 여러 프로필을 순차적으로 실행하는 '시퀀스 자동' 기능을 추가합니다.

1.  **시작 시간 도달 시**: 간단한 알림음과 함께 **자동 매매 시작**.
2.  **종료 시간 도달 시**:
    *   **기본 동작**: 알람음 발생 + **매매 계속 진행** (멈추지 않음).
    *   **'시퀀스 자동' 체크 시**: 현재 프로필 종료 -> **다음 프로필(1->2->3) 자동 로드 및 시작** (시간이 이어지면 자동 연장).
3.  **UI 추가**: '시퀀스 자동' 체크박스 추가.

## 사용자 검토 필요 사항 (User Review Required)
- **프로필 순서**: 기본적으로 1번 -> 2번 -> 3번 순서로 동작합니다.
- **알람 소리**: 시작 시에는 짧은 비프음, 종료(또는 전환) 시에는 기존 알람음을 사용합니다.

## 변경 제안 (Proposed Changes)

### GUI 및 로직 수정
#### [MODIFY] [Kipo_GUI_main.py](file:///d:/Work/Python/AutoBuy/KipoBuy4.2/Kipo_GUI_main.py)
- **UI**: '설정 저장' 버튼 근처에 `QCheckBox("시퀀스 자동")` 추가.
- **데이터**: `settings.json`에 `sequence_auto` (bool) 저장 및 로드 로직 추가.
- **타이머 로직 (`check_alarm` 개선)**:
    - **[시작 시간 체크]**:
        - 현재 시간이 `Start Time`과 일치하고, 상태가 `READY`라면? -> `winsound.MessageBeep`, `start` 명령 실행.
    - **[종료 시간 체크]**:
        - 현재 시간이 `End Time`과 일치하면?
        - **Case A (시퀀스 끄기)**: 알람(`start_alarm`) 울림. **매매 중단 안 함**.
        - **Case B (시퀀스 켜기)**:
            - 현재 프로필 번호 확인.
            - 다음 프로필(Current + 1) 데이터 로드 시도.
            - 성공 시: 설정 적용 -> 로그 출력("🔄 시퀀스: 프로필 X번으로 전환") -> 매매 계속(시간 자동 연장 효과).
            - 실패 시(마지막 번호 등): 알람 울림 + `stop` 명령(매매 중단).

## 검증 계획 (Verification Plan)
1.  **기본 알람 테스트**: 종료 시간 설정 후 도달 시 알람 울리고 매매가 멈추지 않는지 확인.
2.  **시퀀스 테스트**:
    - 프로필 1 (End: 10:00), 프로필 2 (Start: 10:00) 설정.
    - 10:00 도달 시 프로필 2로 설정이 바뀌고 매매가 유지되는지 확인.
